/*! @asymmetrik/angular2-leaflet - 2.1.4 - Copyright Asymmetrik, Ltd. 2007-2017 - All Rights Reserved. + */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("leaflet")):"function"==typeof define&&define.amd?define(["exports","@angular/core","leaflet"],e):e(t.angular2Leaflet=t.angular2Leaflet||{},t.ng.core,t.L)}(this,function(t,e,r){"use strict";var n=function(){function t(t){this.DEFAULT_ZOOM=1,this.DEFAULT_CENTER=r.latLng([38.907192,-77.036871]),this.DEFAULT_FPZ_OPTIONS={},this.fitBoundsOptions=this.DEFAULT_FPZ_OPTIONS,this.panOptions=this.DEFAULT_FPZ_OPTIONS,this.zoomOptions=this.DEFAULT_FPZ_OPTIONS,this.zoomPanOptions=this.DEFAULT_FPZ_OPTIONS,this.options={},this.mapReady=new e.EventEmitter,this.element=t}return t.prototype.ngOnInit=function(){this.map=r.map(this.element.nativeElement,this.options),null!=this.center&&null!=this.zoom&&this.setView(this.center,this.zoom),null!=this.fitBounds&&this.setFitBounds(this.fitBounds),this.doResize(),this.mapReady.emit(this.map)},t.prototype.ngOnChanges=function(t){t.zoom&&t.center&&null!=this.zoom&&null!=this.center?this.setView(t.center.currentValue,t.zoom.currentValue):t.zoom?this.setZoom(t.zoom.currentValue):t.center&&this.setCenter(t.center.currentValue),t.fitBounds&&this.setFitBounds(t.fitBounds.currentValue)},t.prototype.getMap=function(){return this.map},t.prototype.onResize=function(){this.delayResize()},t.prototype.doResize=function(){this.map.invalidateSize({})},t.prototype.delayResize=function(){null!=this.resizeTimer&&clearTimeout(this.resizeTimer),this.resizeTimer=setTimeout(this.doResize.bind(this),200)},t.prototype.setView=function(t,e){this.map&&null!=t&&null!=e&&this.map.setView(t,e,this.zoomPanOptions)},t.prototype.setZoom=function(t){this.map&&null!=t&&this.map.setZoom(t,this.zoomOptions)},t.prototype.setCenter=function(t){this.map&&null!=t&&this.map.panTo(t,this.panOptions)},t.prototype.setFitBounds=function(t){this.map&&null!=t&&this.map.fitBounds(t,this.fitBoundsOptions)},t}();n.decorators=[{type:e.Directive,args:[{selector:"[leaflet]"}]}],n.ctorParameters=function(){return[{type:e.ElementRef}]},n.propDecorators={fitBoundsOptions:[{type:e.Input,args:["leafletFitBoundsOptions"]}],panOptions:[{type:e.Input,args:["leafletPanOptions"]}],zoomOptions:[{type:e.Input,args:["leafletZoomOptions"]}],zoomPanOptions:[{type:e.Input,args:["leafletZoomPanOptions"]}],options:[{type:e.Input,args:["leafletOptions"]}],mapReady:[{type:e.Output,args:["leafletMapReady"]}],zoom:[{type:e.Input,args:["leafletZoom"]}],center:[{type:e.Input,args:["leafletCenter"]}],fitBounds:[{type:e.Input,args:["leafletFitBounds"]}],onResize:[{type:e.HostListener,args:["window:resize",[]]}]};var o=function(){function t(t){this.leafletDirective=t}return t.prototype.init=function(){},t.prototype.getMap=function(){return this.leafletDirective.getMap()},t}(),i=function(){function t(t,e){this.remove=t,this.add=e}return t}(),s=function(){function t(){}return t.diffLayers=function(t,e){var r,n;return null==t&&(t=[]),null==e&&(e=[]),r=e.filter(function(e){return!t.find(function(t){return e===t})}),n=t.filter(function(t){return!e.find(function(e){return t===e})}),new i(r,n)},t}(),a=function(){function t(t){this.leafletDirective=new o(t)}return t.prototype.ngOnInit=function(){this.leafletDirective.init(),this.setLayers(this.layers,[])},t.prototype.ngOnChanges=function(t){if(t.layers){var e=t.layers.currentValue,r=t.layers.isFirstChange()?[]:t.layers.previousValue;this.setLayers(e,r)}},t.prototype.setLayers=function(t,e){var r=this.leafletDirective.getMap();if(null!=r){var n=s.diffLayers(t,e);n.remove.forEach(function(t){r.removeLayer(t)}),n.add.forEach(function(t){r.addLayer(t)})}},t}();a.decorators=[{type:e.Directive,args:[{selector:"[leafletLayers]"}]}],a.ctorParameters=function(){return[{type:n}]},a.propDecorators={layers:[{type:e.Input,args:["leafletLayers"]}]};var l=function(){function t(){}return t.mergeMaps=function(t,e){var r={};if(null!=t)for(var n in t)t.hasOwnProperty(n)&&(r[n]=t[n]);if(null!=e)for(var n in e)e.hasOwnProperty(n)&&(r[n]=e[n]);return r},t.mapSubtract=function(t,e){var r={};if(null!=t){for(var n in t)t.hasOwnProperty(n)&&(r[n]=t[n]);if(null!=e)for(var n in e)e.hasOwnProperty(n)&&delete r[n]}return r},t.mapToArray=function(t){var e=[];for(var r in t)t.hasOwnProperty(r)&&e.push(t[r]);return e},t}(),u=function(){function t(t,e){this.remove=t,this.add=e}return t}(),p=function(){function t(){}return t.prototype.getLayersControl=function(){return this.layersControl},t.prototype.init=function(t,e){var n=t.baseLayers||{},o=t.overlays||{};return this.layersControl=r.control.layers(n,o,e),this.layersControl},t.prototype.setLayersControlConfig=function(t,e){if(null==this.layersControl)return new u({},{});var r,n,o;r=l.mergeMaps(l.mapSubtract(e.baseLayers,t.baseLayers),l.mapSubtract(e.overlays,t.overlays)),n=l.mapSubtract(t.baseLayers,e.baseLayers),o=l.mapSubtract(t.overlays,e.overlays);for(var i in r)if(r.hasOwnProperty(i)){var s=r[i];this.layersControl.removeLayer(s)}for(var i in n)if(n.hasOwnProperty(i)){var s=n[i];this.layersControl.addBaseLayer(s,i)}for(var i in o)if(o.hasOwnProperty(i)){var s=o[i];this.layersControl.addOverlay(s,i)}return new u(r,l.mergeMaps(n,o))},t}(),f=function(){function t(t){this.leafletDirective=new o(t),this.controlLayers=new p}return t.prototype.ngOnInit=function(){this.leafletDirective.init(),this.controlLayers.init(this.layersControlConfig,this.layersControlOptions).addTo(this.leafletDirective.getMap())},t.prototype.ngOnChanges=function(t){t.layersControlCfg&&this.controlLayers.setLayersControlConfig(t.layersControlCfg.currentValue,t.layersControlCfg.previousValue)},t}();f.decorators=[{type:e.Directive,args:[{selector:"[leafletLayersControl]"}]}],f.ctorParameters=function(){return[{type:n}]},f.propDecorators={layersControlConfig:[{type:e.Input,args:["leafletLayersControl"]}],layersControlOptions:[{type:e.Input,args:["leafletLayersControlOptions"]}]};var y=function(){function t(t,e){this.baseLayers=t,this.overlays=e}return t}(),c=function(){function t(t){this.leafletDirective=new o(t),this.controlLayers=new p}return t.prototype.ngOnInit=function(){this.leafletDirective.init(),this.controlLayers.init({baseLayers:this.baseLayers},this.layersControlOptions).addTo(this.leafletDirective.getMap()),this.syncBaseLayer()},t.prototype.ngOnChanges=function(t){t.baseLayers&&this.setBaseLayers(t.baseLayers.currentValue,t.baseLayers.previousValue)},t.prototype.setBaseLayers=function(t,e){this.controlLayers.setLayersControlConfig(new y(t),new y(e)),this.syncBaseLayer()},t.prototype.syncBaseLayer=function(){var t,e=this.leafletDirective.getMap(),r=l.mapToArray(this.baseLayers);e.eachLayer(function(e){t=r.find(function(t){return e===t})}),null!=t?this.baseLayer=t:r.length>0&&(this.baseLayer=r[0],this.baseLayer.addTo(e))},t}();c.decorators=[{type:e.Directive,args:[{selector:"[leafletBaseLayers]"}]}],c.ctorParameters=function(){return[{type:n}]},c.propDecorators={baseLayers:[{type:e.Input,args:["leafletBaseLayers"]}],layersControlOptions:[{type:e.Input,args:["leafletLayersControlOptions"]}]};var h=function(){function t(){}return t.forRoot=function(){return{ngModule:t,providers:[]}},t}();h.decorators=[{type:e.NgModule,args:[{exports:[n,a,f,c],declarations:[n,a,f,c]}]}],h.ctorParameters=function(){return[]};var m=function(){function t(){}return t.prototype.diffLayers=function(t,e){var r,n;return r=l.mapSubtract(e,t),n=l.mapSubtract(t,e),new u(r,n)},t}(),d=function(){function t(t,e,r){this.type=t,this.url=e,this.options=r}return t.createTileLayer=function(t){var e;switch(t.type){case"xyz":e=L.tileLayer(t.url,t.options);break;case"wms":default:e=L.tileLayer.wms(t.url,t.options)}return e},t.createTileLayers=function(e){var r={};for(var n in e)e.hasOwnProperty(n)&&(r[n]=t.createTileLayer(e[n]));return r},t.prototype.createTileLayer=function(){return t.createTileLayer(this)},t}();t.LeafletModule=h,t.LeafletDirective=n,t.LeafletDirectiveWrapper=o,t.LeafletControlLayersUtil=m,t.LeafletLayersUtil=s,t.LeafletTileLayerDefinition=d,Object.defineProperty(t,"__esModule",{value:!0})});